(this["webpackJsonp@nexys/ddl"]=this["webpackJsonp@nexys/ddl"]||[]).push([[0],{28:function(e,t,n){e.exports=n(60)},33:function(e,t,n){},60:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"LeftRight",(function(){return F}));var r=n(0),o=n.n(r),c=n(21),i=n.n(c);n(33),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var l,u,s=n(5),m=n(2),p=n(7),f={borderTop:"1px solid #e5e5e5",borderBottom:"1px solid #e5e5e5",boxShadow:"0 .25rem .75rem rgba(0, 0, 0, .05)"},d=[{link:"/validate/schema",name:"Validate Schema"},{link:"/openApi",name:"Open Api Conversion"},{link:"/toTS",name:"Model to TypeScript"},{link:"/queryToTS",name:"Query to TypeScript"}],h=function(e){var t=o.a.createElement("header",null,o.a.createElement("div",{style:f,className:"d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-white"},o.a.createElement("h5",{className:"my-0 mr-md-auto font-weight-normal"},o.a.createElement(p.a,{to:"/"},"Digis DDL")),o.a.createElement("nav",{className:"my-2 my-md-0 mr-md-3"},d.map((function(e,t){return o.a.createElement(p.a,{className:"p-2 text-dark",key:t,to:e.link},e.name)})))));return o.a.createElement(o.a.Fragment,null,t,o.a.createElement("div",{className:"container"},e.children))},y=function(e){var t="fa fa-"+e.name;return o.a.createElement("i",{className:t})},g=function(){return o.a.createElement("div",{className:"container"},o.a.createElement("h1",null,"DDL Checker"),o.a.createElement("p",null,"Use the menu to explore the different functionalities of the package"),o.a.createElement("p",null,o.a.createElement("a",{href:"https://github.com/Nexysweb/ddl"},o.a.createElement(y,{name:"code"})," Source")," under MIT license"))},b=n(1),E=n.n(b),v=["Int","Long","Double","LocalDateTime","LocalDate","Boolean","BigDecimal","String"],S=E.a.object().keys({name:E.a.string().alphanum().required(),column:E.a.string().optional(),type:E.a.string().alphanum().required(),optional:E.a.boolean(),permissions:E.a.array().optional(),description:E.a.string().optional()}),O=E.a.object().keys({name:E.a.string().alphanum().required(),uuid:E.a.boolean().optional(),table:E.a.string().optional(),description:E.a.string().optional(),fields:E.a.array().items(S).unique((function(e,t){return e.name===t.name})).required(),permissions:E.a.array().optional(),constraints:E.a.array()}),j=E.a.array().items(O).required(),N=function(e){var t=j.validate(e,{abortEarly:!1});if(void 0===t.error||null===t.error){var n=function(e){var t=[],n=e.map((function(e){var n=e.fields.map((function(e){return e.type})).filter((function(e){return v.indexOf(e)<0}));return t=t.concat(n),e.name})),a=[];return t.map((function(e){return n.indexOf(e)<0&&a.push('"'.concat(e,'" is referenced as a type in params but was never defined')),!0})),a}(JSON.parse(e));return n.length>0?{status:!1,errors:n}:{status:!0,errors:null}}return{status:!1,errors:t.error.details.map((function(e){return e.message+" "+JSON.stringify(e.path)}))}},k=n(24),D=n(25),w=n(26),x=n(27),C=function(e){try{return JSON.parse(e),!0}catch(t){return!1}},J=(l=function(e){var t=N(e);return t&&!t.status&&t.errors?{errors:["the string you entered is not a properly formatted DDL file, try again"].concat(t.errors.map((function(e){return e})))}:t},function(e){return function(e){Object(x.a)(n,e);var t=Object(w.a)(n);function n(e){var a;return Object(k.a)(this,n),(a=t.call(this,e)).state=void 0,a.handleSubmit=function(){var e=a.state.content;if(C(e)){var t=l(e);console.log(t),t.errors?a.setState({errors:t.errors,message:null}):a.setState({errors:null,message:"Congratulations, this is a valid file"})}else a.setState({errors:["the string you entered is not a JSON string, try again"],message:null})},a.handleChange=function(e){var t=e.target.value;a.setState({content:t})},a.state={content:"",errors:null},a}return Object(D.a)(n,[{key:"renderError",value:function(){var e=this.state.errors;return e?o.a.createElement("ul",{className:"list-group"},e.map((function(e,t){return o.a.createElement("li",{className:"list-group-item list-group-item-danger",key:t},e)}))):null}},{key:"renderSuccess",value:function(){var e=this.state.message;return e?o.a.createElement("p",{className:"alert alert-success"},e):null}},{key:"render",value:function(){var e=this.state.content;return o.a.createElement(o.a.Fragment,null,this.renderError(),this.renderSuccess(),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-12"},o.a.createElement("textarea",{className:"form-control",style:{minWidth:"100%",height:"400px"},placeholder:"insert your json here",value:e,onChange:this.handleChange}))),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col"},o.a.createElement("button",{className:"btn btn-primary",type:"submit",onClick:this.handleSubmit},"Validate"))))}}]),n}(o.a.Component)})((function(){})),T=function(){return o.a.createElement("div",{className:"container"},o.a.createElement("h2",null,"Schema Validation"),o.a.createElement(J,null))},L=function(){return o.a.createElement("div",{className:"container"},o.a.createElement("h2",null,"Open Api V3"),o.a.createElement("p",null,"Based on ",o.a.createElement("a",{href:"https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.0.md"},"OpenAPI Specification")),o.a.createElement("p",null,o.a.createElement("b",null,"TODO")))},B=n(4),I=function(e){return o.a.createElement("textarea",{className:"form-control",style:{minWidth:"100%",height:"400px"},placeholder:"insert your json here",value:e.content,onChange:function(t){var n=t.target.value;e.onChange(n)}})},A={display:"block",whiteSpace:"pre-wrap"},q=function(e){return o.a.createElement("code",{style:A},e.value)},R=function(e){return o.a.createElement("p",{className:"alert alert-danger"},e.message)},F=function(e){return o.a.createElement("div",{className:"container"},o.a.createElement("h2",null,e.title),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-6"},e.left),o.a.createElement("div",{className:"col-md-6"},e.right)))},M={name:"Company",uuid:!1,fields:[{type:"LocalDateTime",name:"logDateAdded",optional:!1},{type:"Country",name:"country",column:"country_id",optional:!0},{type:"String",name:"wwId",optional:!0},{type:"String",name:"name",optional:!1},{type:"CompanyStatus",name:"status",column:"status_id",optional:!1},{type:"Int",name:"type",column:"type_id",optional:!1},{type:"User",name:"logUser",column:"log_user_id",optional:!0},{type:"String",name:"ceId",optional:!1}]},_=["LocalDateTime","LocalDate","String","Int","BigDecimal","Double","Boolean"],P=function(e){var t=e.name,n=e.uuid?"uuid: string":"id: number",a=e.fields.map((function(e){var t=e.name,n=e.optional?"?":"",a=function(e){if(_.includes(e))switch(e){case"LocalDateTime":case"LocalDate":return"Date";case"Int":case"BigDecimal":case"Double":return"number";case"Boolean":return"boolean";default:return"string"}return"{id: number} | ".concat(e)}(e.type);return"".concat(t).concat(n,": ").concat(a)})),r=[n].concat(a).join(",\n  ");return"export interface ".concat(t," {\n  ").concat(r,"\n}")},V=function(e){return e.map((function(e){return P(e)})).join("\n\n")},W=function(e){switch(e){case"String":return"Joi.string()";case"Boolean":return"Joi.boolean()";case"Int":case"BigDecimal":case"Double":return"Joi.number()";case"LocalDateTime":return"Joi.date()";case"LocalDate":return"Joi.string()";default:return console.warn('The type "'.concat(e,'" could not be converted to Joi, this may create some errors')),"Joi.string()"}},U=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t?e:e+".required()"},Q=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=e.filter((function(e){return!t.includes(e.name)})).map((function(e){return"  "+e.name+": "+U(W(e.type),e.optional)})).join(",\n");return"Joi.Object({\n"+n+"\n});"},G=function(){var e=Object(r.useState)(JSON.stringify(M,null,2)),t=Object(B.a)(e,2),n=t[0],c=t[1],i=Object(r.useState)(null),l=Object(B.a)(i,2),u=l[0],s=l[1],m=Object(r.useState)(null),p=Object(B.a)(m,2),f=p[0],d=p[1],h=o.a.createElement(o.a.Fragment,null,f&&o.a.createElement(R,{message:f}),o.a.createElement(I,{content:n,onChange:function(e){c(e),C(e)?d(null):d("no json")}}),o.a.createElement("button",{className:"btn btn-primary",type:"button",onClick:function(){try{var e=function(e){var t=JSON.parse(e);return Array.isArray(t)?V(t):t.entities?V(t.entities):P(t)}(n);s(e)}catch(t){d("can't convert")}}},"Convert!"),"\xa0",o.a.createElement("button",{className:"btn btn-secondary",type:"button",onClick:function(){return c("[]")}},"Reset")),y=u&&o.a.createElement(q,{value:u});return o.a.createElement(a.LeftRight,{title:"Schema to Typescript",left:h,right:y})},$=n(13),z=function e(t,n,a){var r=Object.keys(n),o=r.filter((function(e){return"object"===typeof n[e]})).map((function(r){var o=n[r],c=function(e,t,n){var a=n.find((function(t){return t.name===e}));if(!a)throw Error("parent entity cannot be found");var r=a.fields.find((function(e){return e.name===t}));if(!r)throw Error("field cannot be found");return r.type}(t,r,a),i=e(c,o,a);return" & (".concat(r,": ").concat(i,")")})),c=r.filter((function(e){return!0===n[e]}));if(c.length>0)return"Pick<".concat(t,", ").concat(c.map((function(e){return"'".concat(e,"'")})).join(" | "),">");var i=r.filter((function(e){return!1===n[e]}));return i.length>0?"Omit<".concat(t,", ").concat(i.map((function(e){return"'".concat(e,"'")})).join(" | "),">"):t+o.join("")},H=function(e,t,n,a){var r=K(n,a);return"("+z(e,t,a)+r+")[]"},K=function(e,t){var n=Object.keys(e).map((function(n){var a=e[n].projection||{},r=H(n,a,{},t);return" & (".concat(n,": ").concat(r,")")}));return 0===n.length?"":n.join("")},X=function(e,t){return function(e,t){var n=Object.keys(e).map((function(n){var a=e[n].projection||{},r=e[n].references||{},o=H(n,a,r,t);return"".concat(n,": ").concat(o)})).join(", ");return"{".concat(n,"}")}(JSON.parse(e),JSON.parse(t))},Y=[{name:"MyEntity",fields:[{name:"f1",type:"String"},{name:"f2",type:"Integer"},{name:"f1",type:"Boolean",optional:!0},{name:"status",type:"EntityName2",optional:!0}]},{name:"EntityName2",fields:[{name:"name",type:"String"}]}],Z=(u={},Object($.a)(u,"MyEntity",{projection:{status:{name:!0,address:!0}}}),Object($.a)(u,"EntityName2",{}),u),ee=function(){var e=Object(r.useState)(JSON.stringify(Y,null,2)),t=Object(B.a)(e,2),n=t[0],c=t[1],i=Object(r.useState)(JSON.stringify(Z,null,2)),l=Object(B.a)(i,2),u=l[0],s=l[1],m=Object(r.useState)(null),p=Object(B.a)(m,2),f=p[0],d=p[1],h=Object(r.useState)(null),y=Object(B.a)(h,2),g=y[0],b=y[1],E=o.a.createElement(o.a.Fragment,null,g&&o.a.createElement(R,{message:g}),o.a.createElement("h4",null,"Query"),o.a.createElement(I,{content:u,onChange:function(e){s(e),C(e)?b(null):b("no json")}}),o.a.createElement("h4",null,"Model"),o.a.createElement(I,{content:n,onChange:function(e){c(e),C(e)?b(null):b("no json")}}),o.a.createElement("button",{className:"btn btn-primary",type:"button",onClick:function(){try{var e=X(u,n);d(e)}catch(t){b("can't convert")}}},"Get output TypeScript type!"),"\xa0",o.a.createElement("button",{className:"btn btn-secondary",type:"button",onClick:function(){c("[]"),s("[]")}},"Reset")),v=f&&o.a.createElement(q,{value:f});return o.a.createElement(a.LeftRight,{title:"Schema to Typescript",left:E,right:v})},te=function(){var e=Object(r.useState)(JSON.stringify(M.fields,null,2)),t=Object(B.a)(e,2),n=t[0],c=t[1],i=Object(r.useState)(null),l=Object(B.a)(i,2),u=l[0],s=l[1],m=Object(r.useState)(null),p=Object(B.a)(m,2),f=p[0],d=p[1],h=o.a.createElement(o.a.Fragment,null,f&&o.a.createElement(R,{message:f}),o.a.createElement(I,{content:n,onChange:function(e){c(e),C(e)?d(null):d("no json")}}),o.a.createElement("button",{className:"btn btn-primary",type:"button",onClick:function(){try{var e=function(e){var t=JSON.parse(e);return Q(t)}(n);s(e)}catch(t){d("can't convert")}}},"Convert!"),"\xa0",o.a.createElement("button",{className:"btn btn-secondary",type:"button",onClick:function(){return c("[]")}},"Reset")),y=u&&o.a.createElement(q,{value:u});return o.a.createElement(a.LeftRight,{title:"Schema to Joi",left:h,right:y})},ne=function(){return o.a.createElement("p",null,"Page Not Found")};var ae=Object(s.f)((function(){return o.a.createElement(h,null,o.a.createElement(s.c,null,o.a.createElement(s.a,{exact:!0,path:"/",component:g}),o.a.createElement(s.a,{exact:!0,path:"/validate/schema",component:T}),o.a.createElement(s.a,{exact:!0,path:"/openApi",component:L}),o.a.createElement(s.a,{exact:!0,path:"/toTS",component:G}),o.a.createElement(s.a,{exact:!0,path:"/queryToTs",component:ee}),o.a.createElement(s.a,{exact:!0,path:"/toJoi",component:te}),o.a.createElement(s.a,{path:"/",component:ne})))})),re=m.a({basename:"/ddl"});i.a.render(o.a.createElement(s.b,{history:re},o.a.createElement(ae,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[28,1,2]]]);
//# sourceMappingURL=main.621edcac.chunk.js.map